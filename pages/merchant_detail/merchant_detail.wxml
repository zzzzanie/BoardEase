<scroll-view scroll-y="true" style="height:100vh; padding-bottom: 120rpx;">
  <view class="merchant-header">
    <image class="merchant-banner" src="{{merchant.logo || merchant.img}}" />
    <view class="merchant-title-row">
      <text class="merchant-title">{{merchant.name}}</text>
    </view>
    <view class="merchant-badges">
      <view class="badge badge-verify">平台已验证</view>
      <view class="badge badge-insure" bindtap="onShowBasicInsurance">已投基础保</view>
      <text class="score">⭐{{merchant.score}}</text>
      <view class="contact-merchant-btn" bindtap="onContactMerchant">联系商家</view>
    </view>
    <view class="merchant-address">地址：{{merchant.address}}</view>
  </view>

  <!-- 资格展示 -->
  <view class="cert-section">
    <view class="cert-title">资格展示</view>
    <view class="cert-list">
              <image class="cert-img" src="https://636c-cloudbase-5gkjpend4a9022ba-1366660379.tcb.qcloud.la/example_cert_1.png" data-url="https://636c-cloudbase-5gkjpend4a9022ba-1366660379.tcb.qcloud.la/images/example_cert_1.png" bindtap="onPreviewCert" />
        <image class="cert-img" src="https://636c-cloudbase-5gkjpend4a9022ba-1366660379.tcb.qcloud.la/example_cert_2.png" data-url="https://636c-cloudbase-5gkjpend4a9022ba-1366660379.tcb.qcloud.la/images/example_cert_2.png" bindtap="onPreviewCert" />
        <image class="cert-img" src="https://636c-cloudbase-5gkjpend4a9022ba-1366660379.tcb.qcloud.la/example_license.png" data-url="https://636c-cloudbase-5gkjpend4a9022ba-1366660379.tcb.qcloud.la/images/example_license.png" bindtap="onPreviewCert" />
    </view>
  </view>

  <!-- 商家碎碎念 -->
  <view class="merchant-note">
    <view class="note-title">商家碎碎念</view>
    <view class="note-content">{{merchant.fullDesc || merchant.selfDesc}}</view>
    <view class="note-pet-types">可寄养类型：{{merchant.petTypes}}</view>
    <view class="note-filters">
      <text>优势：</text>
      <text class="note-filter" wx:for="{{merchant.fosterTypeArr || merchant.filters}}" wx:key="f">{{item}}</text>
    </view>
  </view>

  <!-- 服务项目 -->
  <view class="service-section">
    <view class="service-title">服务项目</view>
    <view class="service-list">
      <block wx:for="{{merchant.services}}" wx:key="name">
        <view class="service-item {{selectedServiceIndex === index ? 'selected' : ''}}" bindtap="onSelectService" data-index="{{index}}">
          <view class="service-name">{{item.name}}</view>
          <view class="service-price">￥{{item.price}}/晚</view>
          <view class="service-desc">{{item.desc}}</view>
          <image wx:if="{{selectedServiceIndex === index}}" src="https://636c-cloudbase-5gkjpend4a9022ba-1366660379.tcb.qcloud.la/icon_checked.png" class="service-checked"/>
        </view>
      </block>
    </view>
  </view>

  <!-- 以下情况无法寄养 -->
  <view class="unavailable-section">
    <view class="unavailable-title">以下情况无法寄养</view>
    <view class="unavailable-desc">{{merchant.cannotFoster || merchant.unavailableDesc}}</view>
  </view>

  <!-- 不可接单日期 -->
  <view class="unavailable-dates-section" wx:if="{{merchant.unavailableDates && merchant.unavailableDates.length > 0}}">
    <view class="unavailable-dates-title">不可接单日期</view>
    <view class="unavailable-dates-list">
      <text class="unavailable-date" wx:for="{{merchant.unavailableDates}}" wx:key="*this">{{item}}</text>
    </view>
  </view>

  <!-- 商家寄养环境 -->
  <view class="env-title">商家寄养环境</view>
  <scroll-view class="env-section" scroll-x="true">
    <block wx:for="{{merchant.environment || merchant.envImgs}}" wx:key="*this">
      <image class="env-img" src="{{item}}" />
    </block>
  </scroll-view>

  <!-- 实时监控 -->
  <view class="monitor-section">
    <view class="monitor-title">实时监控</view>
      <video id="monitorVideo" class="monitor-video" src="https://636c-cloudbase-5gkjpend4a9022ba-1366660379.tcb.qcloud.la/merchant_monitor.mp4" show-center-play-btn="true" controls="true" poster="https://636c-cloudbase-5gkjpend4a9022ba-1366660379.tcb.qcloud.la/example_service_1.png" object-fit="cover" initial-time="0" enable-progress-gesture="true" />
  </view>

  <!-- 评价区块 -->
  <view class="review-section" bindtap="onViewAllReviews">
    <text>查看全部评价 ({{reviews.length}})</text>
  </view>
  <view class="review-list">
    <block wx:for="{{reviews.slice(0,2)}}" wx:key="id">
      <view class="review-item">
        <view class="review-header">
          <text class="review-user">{{item.user}}</text>
          <text class="review-score">⭐{{item.score}}</text>
        </view>
        <view class="review-content">{{item.content}}</view>
      </view>
    </block>
  </view>

  <!-- 评价弹窗 -->
  <view wx:if="{{showReviewModal}}" class="modal-mask" bindtap="onCloseReviewModal">
    <view class="modal-content" bindtap="stopPropagation">
      <view class="modal-title">全部评价</view>
      <scroll-view style="max-height: 60vh;" scroll-y="true">
        <block wx:for="{{reviews}}" wx:key="id">
          <view class="review-item">
            <view class="review-header">
              <text class="review-user">{{item.user}}</text>
              <text class="review-score">⭐{{item.score}}</text>
            </view>
            <view class="review-content">{{item.content}}</view>
          </view>
        </block>
      </scroll-view>
      <button class="close-btn" bindtap="onCloseReviewModal">关闭</button>
    </view>
  </view>

  <!-- 基础保险弹窗 -->
  <view wx:if="{{showBasicInsuranceModal}}" class="modal-mask" bindtap="onCloseBasicInsuranceModal">
    <view class="modal-content insurance-modal" bindtap="stopPropagation">
      <view class="modal-title">基础保险详情</view>
      <image class="insurance-img" src="https://636c-cloudbase-5gkjpend4a9022ba-1366660379.tcb.qcloud.la/basic_insurance.png" mode="widthFix"/>
      <button class="close-btn" bindtap="onCloseBasicInsuranceModal">关闭</button>
    </view>
  </view>
</scroll-view>

<view class="bottom-btn">
  <button bindtap="onBookNow">立即寄养</button>
</view>