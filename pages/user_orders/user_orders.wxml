<view class="container">
  <view class="tabs">
    <view class="tab-item {{currentTab === 'all' ? 'active' : ''}}" bindtap="changeTab" data-tab="all">全部</view>
    <view class="tab-item {{currentTab === 'active' ? 'active' : ''}}" bindtap="changeTab" data-tab="active">进行中</view>
    <view class="tab-item {{currentTab === 'completed' ? 'active' : ''}}" bindtap="changeTab" data-tab="completed">已完成</view>
  </view>

  <view class="order-list">
    <block wx:if="{{orders.length > 0}}">
      <view wx:for="{{orders}}" wx:for-item="order" wx:for-index="index" wx:key="_id" class="order-item card">
        <view class="order-header flex-space-between">
          <text class="shop-name">{{order.shopName}}</text>
          <text class="order-status">{{order.statusText}}</text>
        </view>
        <view class="order-content" bindtap="goToOrderDetail" data-id="{{order._id}}">
          <image class="service-image" src="{{item.logo || 'https://636c-cloudbase-5gkjpend4a9022ba-1366660379.tcb.qcloud.la/logo_1.png'}}" mode="aspectFill"></image>
          <view class="service-details">
            <text class="service-title text-overflow-single">{{order.serviceTitle}}</text>
            <text class="service-duration">{{order.orderTime}}天</text>
            <text class="order-total-price">总价: ¥{{order.totalPrice}}</text>
          </view>
        </view>
        
        <view class="order-footer">
          
          <block wx:if="{{order.status === 'pending'}}">
            <button class="order-btn secondary-button-small" bindtap="cancelOrder" data-id="{{order._id}}" bindtap:stop="true">取消订单</button>
            <button class="order-btn secondary-button-small" bindtap="contactSeller" data-index="{{index}}" bindtap:stop="true">联系卖家</button>
            <button class="order-btn secondary-button-small" bindtap="goToOrderDetail" data-id="{{order._id}}" bindtap:stop="true">查看详情</button>
          </block>

          <block wx:elif="{{order.status === 'processing'}}">
            <button class="order-btn secondary-button-small" bindtap="contactSeller" data-index="{{index}}" bindtap:stop="true">联系卖家</button>
            <button class="order-btn secondary-button-small" bindtap="goToOrderDetail" data-id="{{order._id}}" bindtap:stop="true">查看详情</button>
          </block>

          <block wx:elif="{{order.status === 'completed'}}">
            <button class="order-btn rate-order-button" bindtap="goToRateOrder" data-id="{{order._id}}" bindtap:stop="true">去评价</button>
            <button class="order-btn secondary-button-small" bindtap="contactSeller" data-index="{{index}}" bindtap:stop="true">联系卖家</button>
            <button class="order-btn secondary-button-small" bindtap="goToOrderDetail" data-id="{{order._id}}" bindtap:stop="true">查看详情</button>
          </block>
          
          <block wx:else>
            <button class="order-btn secondary-button-small auto-margin-left" bindtap="goToOrderDetail" data-id="{{order._id}}" bindtap:stop="true">查看详情</button>
          </block>
        </view>
      </view>
    </block>
    <view wx:else class="no-data-hint">
      <text>当前状态下没有订单</text>
    </view>
  </view>
</view>